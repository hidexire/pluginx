{% if not field.validate.ignore %}

{% set field_name = (scope ~ field.name)|fieldName %}
{% set vertical = field.style == 'vertical' %}

{% if not blueprints or (blueprints.schema.type(field.type)['input@'] ?? true) is same as(true) %}
    {% set toggleable = field.toggleable ?? false %}
    {% if toggleable %}
        {% set originalValue = originalValue is defined ? originalValue : value %}
        {% set toggleableChecked = originalValue is not null and originalValue is not empty %}
    {% elseif field.overridable %}
        {% set toggleable = true %}
        {% set default = form.getDefaultValue(field.name) ?? field.default %}
        {% set toggleableChecked = value != default %}
    {% endif %}

    {% set cookie_name = 'forms-' ~ form.name ~ '-' ~ field.name %}
    {% set value = value ?? (get_cookie(cookie_name) is not null ? get_cookie(cookie_name) : field.default) %}

    {% if (field.yaml or field.validate.type == 'yaml') and value is iterable %}
        {% set value = value|toYaml %}
    {% endif %}
{% else %}
    {% set toggleable = false %}
{% endif %}

{# DEPRECATED: Needed by old form fields; remove when backwards compatibility breaks are allowed #}
{% set isDisabledToggleable = toggleable and not toggleableChecked %}

{% if toggleable %}
  {% set form_field_toggleable %}
    {% include 'forms/default/toggleable.html.twig' with {checked: toggleableChecked} %}
  {% endset %}
{% endif %}

{% set errors = attribute(form.messages, field.name) %}
{% set required = client_side_validation and field.validate.required in ['on', 'true', 1] %}
{% set autofocus = (inline_errors == false) and field.autofocus in ['on', 'true', 1] %}

{% if inline_errors and errors %}
    {% set autofocus = true %}
{% endif %}

{% set embed_outer_field_classes %}
  {% block outer_field_classes %}{% endblock %}
{% endset %}

{# Field Classes #}
{%- if errors %}{% set form_field_outer_classes = form_field_outer_classes|trim ~ ' ' ~ 'has-errors '  %}{% endif -%}
{%- if toggleable %}{% set form_field_outer_classes = form_field_outer_classes ~ 'form-field-toggleable '  %}{% endif -%}
{%- if field.outerclasses %}{% set form_field_outer_classes = form_field_outer_classes ~ field.outerclasses ~ ' ' %}{% endif -%}
{%- if embed_outer_field_classes|trim %}{% set form_field_outer_classes = form_field_outer_classes ~ embed_outer_field_classes ~ ' ' %}{% endif -%}

{# Show Label logic #}
{% set show_label = field.label is not same as(false) and field.display_label is not same as(false )%}

{# Label Classes #}
{% set form_field_outer_label_classes = (form_field_outer_label_classes ?: 'form-label' ~ ' ' ~ field.labelclasses)|trim %}
{% set form_field_label_classes = (form_field_label_classes ?: 'inline' ~ ' ' ~ toggleable ? 'toggleable ')|trim %}

{# Field For #}
{% set form_field_for = toggleable ? 'toggleable_' ~ field.name : field.id|e %}



{# Field Label #}
{% set form_field_label = field.markdown ? field.label|markdown(false) : field.label %}
{% set form_field_label = form_field_label|default(field.name|capitalize)|t|e('html_attr') %}

{# Field Help #}
{% if field.help %}
    {% set form_field_help = field.markdown ? field.help|t|markdown(false)|e : field.help|t|e %}
{% endif %}

{# Field Requied #}
{% set form_field_required = field.validate.required in ['on', 'true', 1] ? true : false %}

{# Embed Logic #}
{% set embed_field_contents %}
  {% block contents %}{% endblock %}
{% endset %}

{% set embed_field_label %}
  {% block label %}{% endblock %}
{% endset %}

{% set embed_field_help %}

{% endset %}

{% block field %}
  {% embed 'forms/layouts/field.html.twig' %}

    {% block contents %}
     {{ embed_field_contents|trim ? embed_field_contents : parent() }}
    {% endblock %}

    {% block label %}
      {{ embed_field_label|trim ? embed_field_label : parent() }}
    {% endblock %}

  {% endembed %}


{% endblock %}

{% endif %}
